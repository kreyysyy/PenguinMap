(this.webpackJsonppenguin_map=this.webpackJsonppenguin_map||[]).push([[0],{34:function(e,t,n){},36:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(0),s=n.n(r),o=n(25),i=n.n(o),c=(n(34),n(16)),l=n(20),u=n.n(l),p=n(23),h=n(6),d=n(26),g=n(13),m=n(14),f=n(11),j=n(17),b=n(15),x=(n(36),n(37),n(27)),v=n(28),y=n(9),O=n(7),L=n(21),C=n.n(L),k=n(22),S=n.n(k),w="./Place_PenguinList.geojson",M=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).SELECT_ALL="\uff1c\u5168\u3066\uff1e",a.state={lng:136,lat:37,zoom:3.5,penguinNumMin:0,penguinNumMax:0,dropdownPlace:[],dropdownPlaceSelected:a.SELECT_ALL,checkboxPenguin:(new Map).set(a.SELECT_ALL,!0),geojson:null},a.map=null,a.checkboxPenguinChanged=a.checkboxPenguinChanged.bind(Object(f.a)(a)),a.dropdownPlaceChanged=a.dropdownPlaceChanged.bind(Object(f.a)(a)),a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.readGeoJSON().then((function(){e.createMap()}))}},{key:"render",value:function(){var e,t,n=this;return t=Object(a.jsx)(O.a,{children:Object(a.jsxs)(O.a.Group,{controlId:"exampleForm.SelectCustom",children:[Object(a.jsx)(O.a.Label,{children:"\u52d5\u7269\u5712\u30fb\u6c34\u65cf\u9928"}),Object(a.jsx)(O.a.Control,{as:"select",custom:!0,value:this.state.dropdownPlaceSelected,onChange:this.dropdownPlaceChanged,children:this.state.dropdownPlace.map((function(e){return Object(a.jsx)("option",{value:e,children:e},e)}))})]})}),e=Object(a.jsxs)(O.a,{children:[Object(a.jsx)(O.a.Label,{children:"\u30da\u30f3\u30ae\u30f3"}),Array.from(this.state.checkboxPenguin.keys()).map((function(e){var t=n.state.checkboxPenguin.get(e);return Object(a.jsx)(O.a.Check,{value:e,type:"checkbox",checked:t,label:e.replace(/\u30da\u30f3\u30ae\u30f3$/,""),onChange:n.checkboxPenguinChanged},e)}))]}),Object(a.jsx)(x.a,{fluid:!0,children:Object(a.jsxs)(v.a,{children:[Object(a.jsx)(y.a,{xs:12,sm:8,md:9,lg:5,xl:6,children:Object(a.jsxs)("div",{className:"container-frame",children:[Object(a.jsx)("div",{ref:function(e){return n.mapContainer=e},className:"map-container"}),Object(a.jsxs)("div",{className:"map-overlay",children:[Object(a.jsxs)("div",{className:"map-title",children:[Object(a.jsx)("h5",{children:"\u30da\u30f3\u30ae\u30f3\u30de\u30c3\u30d7"}),"\u30da\u30f3\u30ae\u30f3\u304c\u3044\u308b\u52d5\u7269\u5712\u30fb\u6c34\u65cf\u9928"]}),Object(a.jsxs)("div",{id:"legend",className:"map-legend",children:["\u98fc\u80b2\u3055\u308c\u3066\u3044\u308b\u30da\u30f3\u30ae\u30f3\u306e\u7a2e\u985e\u6570",Object(a.jsx)("div",{className:"map-legend-bar"}),Object(a.jsx)("table",{className:"map-legend-bar-text",children:Object(a.jsx)("tbody",{children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{align:"left",children:this.state.penguinNumMin}),Object(a.jsx)("td",{align:"right",children:this.state.penguinNumMax})]})})})]})]})]})}),Object(a.jsx)(y.a,{xs:4,sm:4,md:3,lg:3,xl:2,children:Object(a.jsx)("div",{className:"container-frame",children:Object(a.jsxs)("div",{className:"selector-container",children:[t,e]})})}),Object(a.jsxs)(y.a,{xs:8,sm:12,md:12,lg:4,xl:4,children:[Object(a.jsx)(P,{geojson:this.state.geojson}),Object(a.jsx)(N,{geojson:this.state.geojson})]})]})})}},{key:"readGeoJSON",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a,r,s,o,i,c,l,d,g,m,f,j,b,x,v;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(w);case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,console.log("read file: "+w),a=n.features.map((function(e){return e.properties.penguin_num})).reduce((function(e,t){return Math.max(e,t)})),r=n.features.map((function(e){return e.properties.penguin_num})).reduce((function(e,t){return Math.min(e,t)})),s=Array.from(new Set(n.features.map((function(e){return e.properties.place})))).sort(),o=new Set,i=Object(h.a)(n.features);try{for(i.s();!(c=i.n()).done;){l=c.value,d=Object(h.a)(l.properties.penguin.split("_"));try{for(d.s();!(g=d.n()).done;)m=g.value,o.add(m)}catch(u){d.e(u)}finally{d.f()}}}catch(u){i.e(u)}finally{i.f()}f=Array.from(o).sort(),(j=new Map).set(this.SELECT_ALL,!0),b=Object(h.a)(f);try{for(b.s();!(x=b.n()).done;)v=x.value,j.set(v,!0)}catch(u){b.e(u)}finally{b.f()}this.setState({geojson:n,penguinNumMin:r,penguinNumMax:a,dropdownPlace:[this.SELECT_ALL].concat(Object(p.a)(s)),dropdownPlaceSelected:this.SELECT_ALL,checkboxPenguin:j});case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"createMap",value:function(){var e=this;this.map=new C.a.Map({container:this.mapContainer,style:{version:8,sources:{OSM:{type:"raster",tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png","https://c.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"OSM",type:"raster",source:"OSM"}],glyphs:"https://fonts.openmaptiles.org/{fontstack}/{range}.pbf"},attributionControl:!0,customAttribution:['Map: \xa9 <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors','Data: refer to <a href="https://www.jaza.jp/" target="_blank">JAZA (2020/12/7)</a>'],center:[this.state.lng,this.state.lat],zoom:this.state.zoom}),this.map.on("load",(function(){e.map.addSource("source-place",{type:"geojson",data:w}),e.map.addLayer({id:"layer-place",type:"circle",source:"source-place",layout:{},paint:{"circle-stroke-width":1,"circle-stroke-color":"black","circle-color":["interpolate",["linear"],["get","penguin_num"],e.state.penguinNumMin,"blue",(e.state.penguinNumMax-e.state.penguinNumMin)/2,"yellow",e.state.penguinNumMax,"red"]}}),e.map.addLayer({id:"layer-place-label",type:"symbol",source:"source-place",layout:{"text-field":["format",["get","place"]],"text-anchor":"bottom","text-radial-offset":.7,"text-font":["Open Sans Regular"]},paint:{"text-halo-width":2,"text-halo-color":"rgba(255, 255, 255, 255)"}})})),this.map.on("move",(function(){e.setState({lng:e.map.getCenter().lng,lat:e.map.getCenter().lat,zoom:e.map.getZoom()})}));var t=new C.a.Popup({closeButton:!1,closeOnClick:!1});this.map.on("mouseenter","layer-place",(function(n){e.map.getCanvas().style.cursor="pointer";for(var a=n.features[0].geometry.coordinates.slice(),r="<ul>"+n.features[0].properties.penguin.split("_").map((function(e){return"<li>"+e+"</li>"})).join("")+"</ul>",s="<h6>"+n.features[0].properties.place+"</h6>"+r;Math.abs(n.lngLat.lng-a[0])>180;)a[0]+=n.lngLat.lng>a[0]?360:-360;t.setLngLat(a).setHTML(s).addTo(e.map)})),this.map.on("mouseleave","layer-place",(function(){e.map.getCanvas().style.cursor="",t.remove()}))}},{key:"dropdownPlaceChanged",value:function(e){var t=e.target.value;this.map.loaded()&&(t===this.SELECT_ALL?(this.map.setFilter("layer-place",null),this.map.setFilter("layer-place-label",null)):(this.map.setFilter("layer-place",["==",["get","place"],t]),this.map.setFilter("layer-place-label",["==",["get","place"],t]))),this.setState({dropdownPlaceSelected:t})}},{key:"checkboxPenguinChanged",value:function(e){var t=this.state.checkboxPenguin,n=e.target.value,a=e.target.checked;if(t.set(n,!t.get(n)),n===this.SELECT_ALL){var r,s=Object(h.a)(t.keys());try{for(s.s();!(r=s.n()).done;){var o=r.value;t.set(o,a)}}catch(C){s.e(C)}finally{s.f()}}else if(a){var i,l=!0,u=Object(h.a)(t);try{for(u.s();!(i=u.n()).done;){var p=Object(c.a)(i.value,2),d=p[0],g=p[1];if(d!==this.SELECT_ALL&&!1===g){l=!1;break}}}catch(C){u.e(C)}finally{u.f()}l&&t.set(this.SELECT_ALL,!0)}else t.set(this.SELECT_ALL,!1);var m,f=new Set,j=Object(h.a)(t);try{for(j.s();!(m=j.n()).done;){var b=Object(c.a)(m.value,2),x=b[0];if(b[1]){var v,y=Object(h.a)(this.state.geojson.features);try{for(y.s();!(v=y.n()).done;){var O=v.value;O.properties.penguin.includes(x)&&f.add(O.properties.place)}}catch(C){y.e(C)}finally{y.f()}}}}catch(C){j.e(C)}finally{j.f()}var L=Array.from(f);this.map.loaded()&&(this.map.setFilter("layer-place",["in",["get","place"],["literal",L]]),this.map.setFilter("layer-place-label",["in",["get","place"],["literal",L]])),this.setState({checkboxPenguin:t})}}]),n}(s.a.Component),P=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).state={geojson:e.geojson},a}return Object(m.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({geojson:e.geojson})}},{key:"render",value:function(){var e=this,t=this.state.geojson;if(null!=t){var n=Object(p.a)(t.features);return n.sort((function(e,t){return e.properties.penguin_num-t.properties.penguin_num})),Object(a.jsx)("div",{className:"container-frame",children:Object(a.jsx)("div",{className:"graph-container",children:Object(a.jsx)(S.a,{className:"graph",ref:function(t){return e.graph=t},data:[{type:"bar",x:n.map((function(e){return e.properties.penguin_num})),y:n.map((function(e){return e.properties.place})),orientation:"h",text:n.map((function(e){return e.properties.penguin_num})),textposition:"outside",hoverinfo:"x+y"}],layout:{title:"\u98fc\u80b2\u7a2e\u985e\u6570",showlegend:!1,margin:{t:50},height:2e3,xaxis:{side:"top"},yaxis:{automargin:!0},dragmode:!1},config:{responsive:!0,displayModeBar:!1}})})})}return null}}]),n}(s.a.Component),N=function(e){Object(j.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(g.a)(this,n),(a=t.call(this,e)).state={geojson:e.geojson},a}return Object(m.a)(n,[{key:"componentWillReceiveProps",value:function(e){this.setState({geojson:e.geojson})}},{key:"render",value:function(){var e=this,t=this.state.geojson;if(null!=t){var n,r=t.features,s=new Map,o=Object(h.a)(r);try{for(o.s();!(n=o.n()).done;){var i,l=n.value.properties.penguin.split("_"),u=Object(h.a)(l);try{for(u.s();!(i=u.n()).done;){var p=i.value;p=p.replace(/\u30da\u30f3\u30ae\u30f3$/,""),s.has(p)?s.set(p,s.get(p)+1):s.set(p,1)}}catch(x){u.e(x)}finally{u.f()}}}catch(x){o.e(x)}finally{o.f()}var d,g=[],m=Object(h.a)(s);try{for(m.s();!(d=m.n()).done;){var f=Object(c.a)(d.value,2),j=f[0],b=f[1];g.push({pen:j,num:b})}}catch(x){m.e(x)}finally{m.f()}return g.sort((function(e,t){return e.num-t.num})),Object(a.jsx)("div",{className:"container-frame",children:Object(a.jsx)("div",{className:"graph-container",children:Object(a.jsx)(S.a,{className:"graph",ref:function(t){return e.graph=t},data:[{type:"bar",x:g.map((function(e){return e.num})),y:g.map((function(e){return e.pen})),orientation:"h",text:g.map((function(e){return e.num})),textposition:"outside",hoverinfo:"x+y"}],layout:{title:"\u98fc\u80b2\u9928\u6570",margin:{t:50},height:400,xaxis:{side:"top"},yaxis:{automargin:!0},dragmode:!1},config:{responsive:!0,displayModeBar:!1}})})})}return null}}]),n}(s.a.Component),_=M,E=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,46)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,o=t.getTTFB;n(e),a(e),r(e),s(e),o(e)}))};i.a.render(Object(a.jsx)(s.a.StrictMode,{children:Object(a.jsx)(_,{})}),document.getElementById("root")),E()}},[[45,1,2]]]);
//# sourceMappingURL=main.cb073ee8.chunk.js.map